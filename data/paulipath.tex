\chapter{Pauli路径积分模拟}



\section{量子计算的经典模拟}
随着量子计算硬件的快速发展，量子比特规模已达到数百量级（如IBM Quantum Heron处理器）。然而，当前含噪声中等规模量子（NISQ）设备的计算保真度仍受限于退相干时间和门操作误差。在此背景下，量子计算的经典模拟技术具有多重意义：
\begin{itemize}
    \item 量子计算的经典模拟是验证量子计算硬件的有效手段。通过经典模拟，我们可以验证量子计算硬件的正确性，评估其性能，甚至优化量子算法。
    \item 突破现有量子计算硬件的规模限制。通过经典模拟，我们可以模拟更大规模的量子系统，以探索量子计算的潜在应用（如数千量子比特）。
    \item 辅助算法设计。通过经典模拟，为算法提供参数优化、误差分析等支持。
\end{itemize}
在本章中，我们将介绍量子计算的经典模拟方法，重点介绍Pauli路径积分模拟方法。


\subsection{全状态模拟}
常见的量子计算经典模拟方法包括全状态模拟，全状态模拟全状态模拟（Full-State Simulation）是量子计算经典模拟的一种直接方法，即在经典计算机上存储和演化完整的量子态向量或密度矩阵。

在纯态量子计算模型中，一个$n$量子比特的量子态可以用$2^n$维复向量表示：
\begin{equation}
    |\psi\rangle = \sum_{i=0}^{2^n-1} c_i |i\rangle,
    \quad c_i \in \mathbb{C}, \quad \sum_{i=0}^{2^n-1} |c_i|^2 = 1.
\end{equation}
在态向量模拟中，整个量子态向量被存储在计算机内存中。并在应用量子门时，通过矩阵乘法和线性代数运算来模拟量子态的演化：
\begin{equation}
    |\psi'\rangle = U |\psi\rangle,
\end{equation}
其中$U$是一个$2^n \times 2^n$的酉矩阵，表示量子门的作用。
在计算复杂度上，应用一个量子门的计算复杂度为$O(2^n)$。对于存储复杂度，一个$n$量子比特的量子态需要$2^n$个复数来存储。

对于模拟含噪声的量子计算硬件，或是模拟包含量子信道的系统，全状态模拟需要存储和操作$2^n \times 2^n$的密度矩阵：
\begin{equation}
    \rho = \sum_{i,j=0}^{2^n-1} \rho_{ij} |i\rangle\langle j|,
    \quad \rho_{ij} \in \mathbb{C},
\end{equation}
其中$\rho_{ij}$是密度矩阵的元素。在应用量子门时，密度矩阵的演化可以表示为：
\begin{equation}
    \rho' = U \rho U^\dagger.
\end{equation}
如果考虑噪声过程或量子信道，通过Kraus算符$\{K_i\}$描述量子信道的演化：
\begin{equation}
    \rho' = \sum_i K_i \rho K_i^\dagger.
\end{equation}
同样地，对于密度矩阵模拟，计算复杂度和存储复杂度也是关于qubit数目的指数级量级。

全状态模拟的主要优点是直观、易于理解，但其缺点也显而易见：存储复杂度和计算复杂度都是指数级的，因此全状态模拟只适用于小规模量子系统的模拟。对于大规模量子系统，全状态模拟的计算和存储复杂度是无法接受的。因此，我们需要寻找更高效的量子计算经典模拟方法。

\subsection{Stabilizers稳定子模拟}


一个n量子比特的纯态  $|\psi\rangle $ 被称为稳定子态，如果存在一个由n个独立、对易的泡利算符组成的集合  $\{S_1, S_2, …, S_n\}$ ，使得：
\begin{equation}
    S_i |\psi\rangle = |\psi\rangle, \quad \forall i \in \{1, 2, …, n\}.
\end{equation}
每个生成元  $S_i$  是由单比特泡利算符的张量积构成的算符，可以表示为：

\begin{equation}
    S_i = \alpha_i P_{i1} \otimes P_{i2} \otimes … \otimes P_{in},
\end{equation}
其中，  $\alpha_i\in\{-1,+1\}$  是相位因子，  $P_{ij}\in\{I, X, Y, Z\}$  是单比特Pauli算符。


这些算符的集合被称为  $|\psi\rangle $ 的稳定子群（Stabilizer Group），记作 $ \mathcal{S}$ 。由于这些算符是对易的，因此  $\mathcal{S}$  是泡利群的一个阿贝尔子群。
同样的，$n$个对易的泡利算符的集合也可以生成一个稳定子群，且该该稳定子群唯一地对应一个量子态满足$S\ket{\psi_S}=\ket{\psi_S}$对任意$S\in\mathcal{S}$成立。


例如，对于单比特态  $|0\rangle$ ，有：

\begin{equation}
    Z |0\rangle = |0\rangle.
\end{equation}
$|0\rangle$的稳定子群是 $\mathcal{S} = \{I,Z\}$ 。


一个Pauli算符可以用两个boolean值向量和一个相位因子表示：
\begin{equation}
    P = (-1)^\alpha \otimes_{i=1}^n X_i^{x_i} Z_i^{z_i},
\end{equation}
其中，$\alpha\in\{0,1\}$是相位因子，  $x_i, z_i\in\{0,1\}$  是boolean值向量。这意味着，一个Pauli算符可以用一个长度为  $2n+1$  的boolean值向量表示。因此，一个$n\times (2n+1)$的boolean值矩阵可以表示一个稳定子群的完整信息。

同时，因为Pauli算符在Clifford门作用下是闭的，任何的Clifford门构成的量子线路可以通过在作用Clifford门之后更新稳定子群的表格模拟。已知的算法可以实现以$\order{n^2}$的计算复杂度更新一次表格~\cite{PhysRevA.70.052328}。

\section{Pauli路径积分模拟}
在这一节中，我们将介绍一种高效的量子计算经典模拟方法，使用Feynman路径积分的思想，将量子线路的演化结果表示为以Pauli算符为基的路径积分。在本节中，我们将介绍Pauli路径积分模拟方法的基本原理和实现细节。

为了方便，我们假设量子线路$\mathcal{U}$包含$L$层量子门，每一层包含软干个量子门。同一层的量子门作用在不同的量子比特上，因此可以并行作用。对于真实的量子硬件，每一个门能够作用的量子比特数目是有限的，如果限制一个量子门只能作用到至多$k$个量子比特上，我们称为$k$-local量子门。对于常见的量子硬件，如超导量子比特，通常$k=2$。在本章中，我们暂不考虑$k$-local量子门的限制，即我们可以任意选择量子门作用的量子比特，将会在后续复杂度和误差分析中讨论这一问题。为了方便，我们记$\mathcal{U} = \mathcal{U}_L\circ \mathcal{U}_{L-1} \cdots \mathcal{U}_1$，其中$\mathcal{U}_i$表示第$i$层的量子门复合的幺正算符。
假设$\mathcal{U}_i$包含$k_i$个量子门，则第$i$层的幺正算符$\mathcal{U}_i$可以表示为：
\begin{equation}
    \mathcal{U}_i = U_{i,1} \otimes U_{i,2} \otimes \cdots \otimes U_{i,k_i}\otimes I_{\{\supp(U_{i,1})\cup \cdots \cup \supp(U_{i,k_i})\}^c},
\end{equation}
其中$U_{i,j}$表示第$i$层第$j$个量子门，$\supp(U_{i,j})$表示$U_{i,j}$作用的量子比特集合，$I_{\{\supp(U_{i,1})\cup \cdots \cup \supp(U_{i,k_i})\}^c}$表示作用在没有被$U_{i,j}$作用的量子比特上的恒等算符。

假设量子线路$\mathcal{U}$作用在初始量子态$\rho$上，并在演化后在可观测量$O$上进行测量，我们的目标是计算量子线路$\mathcal{U}$的期望值：
\begin{equation}
    \langle O \rangle = \Tr(O \mathcal{U} \rho \mathcal{U}^\dagger).
\end{equation}
为了计算$\langle O \rangle$，我们引入Feynman路径积分的思想，将$\langle O \rangle$表示为以Pauli算符为基的路径积分：
\begin{equation}
    \langle O \rangle = \sum_{\bm{p}} f(\bm{p}),
\end{equation}
其中$\bm{p} = (p_1, p_2, \cdots, p_L)$表示路径，$p_i$表示第$i$层的Pauli算符。我们将在后续章节中详细介绍Pauli算符的表示和性质。
